# Sprintboard

This is React based image viewer as a local server.
You can view images in your storage via web browser from local machine, as well as from any devices connected to the same LAN.
I made this mainly to manage my Stable Diffusion outputs from ComfyUI so most features are optimized for them.

# Features

## View thousands of images on your PC and mobile phones

The server is written in C++ so it can handle thousands of images fast.
Start the server on your desktop PC, and access those images from any devices that have a web browser and are connected to the same Wi-Fi (LAN).

## ComfyUI specific metadata

The server can parse metadata in PNG files and fetch some useful data.
You can apply filters based on this info.

## Use AVIF to save storage

The server can be configured to generate AVIF images out of PNG source images.
PNG metadata that is generated by ComfyUI will be transfered to AVIF images, so the app can use it for filtering and search.
AVIF images are usually 5~15% in size compared to source PNG images, so you may delete PNG images.

# How to start the server

Download prebuilt binary or build it yourself, then run `sprintboard.exe`.
Make sure there's `dist` folder in current working directory.
You should see following messages on console.

```
Serving static files from ./dist
Starting server at http://127.0.0.1:8787
```

Open the link on your favorite web browser.
On the front page, click 'Go to Images' button to open file browser.
In the 'example' folder there should be test images.

# Configs

Upon starting the server, a file named `server_configs.json` must be created.
Open it with any text editor.

```json
{
  "avif_gen": false,
  "avif_gen_remove_src": false,
  "avif_quality": 70.0,
  "avif_speed": 4,
  "dir_bindings": {
    "example": {
      "local_dirs": [
        "./test_cpp/images"
      ]
    }
  },
  "server_host": "127.0.0.1",
  "server_port": 8787,
  "tls-certfile": "",
  "tls-keyfile": ""
}
```

You don't need to touch anything for now except `dir_bindings`. Copy `example` entry to make your own like below.

```json
{
  ...
  "dir_bindings": {
    "example": {
      "local_dirs": [
        "./test_cpp/images"
      ]
    },
    "your images": {
      "local_dirs": [
        "C:\\your\\image\\folder\\path"
      ]
    }
  },
  ...
}
```

Or just edit `example` entry directly.
Note that JSON is unforgiving format.
If you ommit a comma where it's necessary or put a comma where it shouldn't be, the JSON parser entirely fails and you will see following message on the console.

```
Loading server configs from file: sprintboard/server_configs.json
Failed to reload server configs: [json.exception.parse_error.101] parse error at line 12, column 3: syntax error while parsing object key - unexpected '}'; expected string literal
```

If nothing went wrong, you should be able to see your images now.

There are optional parameters.

|Key |Description
|- |-
|`server_host` |IP address to use for the server. Change it to something like `192.168.x.x` to access the web app from your phone.
|`server_port` |Port number to bind. Pick a number you like.
|`tls-certfile` |File path to TLS certification file to enable HTTPS mode.
|`tls-keyfile` |File path for TLS key file to enable HTTPS mode.

These are immutable variables.
If you modify those values, you must restart the server to apply them.

|Key |Description
|- |-
|`avif_gen` |Create AVIF image for each image. If there's AVIF image with same file name, the server will serve it instead.
|`avif_gen_remove_src` |Currently not implemented
|`avif_quality` |Quality option for AVIF encoder.
|`avif_speed` |Speed option for AVIF encoder.
|`dir_bindings` |Add folder directories here. Each key will appear as folder in root folder, and all contents in `local_dirs` will be in it. You may use obsolute and relative paths for `local_dirs`. While you can set multiple directories for a binding, I highly recommend putting only one directory.

If you modify those values, the effect will take place as soon as possible, without restarting the server.

# Guide to view image on iPhone

If you are using a Wi-Fi router, and your PC and mobile phone are connected to it, then you can open web app from your phone.

First, open command prompt and type `ipconfig`.
There must be something like this.

```
Ethernet adapter Apple:

   Connection-specific DNS Suffix  . :
   IPv4 Address. . . . . . . . . . . : 192.168.0.2
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 192.168.0.1
```

In this case, `192.168.0.2` is your PC's LAN address.

Modify `server_host` in `server_configs.json` to `"0.0.0.0"`, and restart the server.
Now you may open web browser on your phone, and in the address bar type `http://192.168.0.2:8787`
If it works, good for you.
Everything else works just like it would on desktop web browser.
For safety, change `server_host` value from `"0.0.0.0"` to `"192.168.0.2"`.

If you understand how this works, you can even browse your images anywhere you go. It is possible to expose 8787 port via port forwarding, and access it via Internet. Though it's very dangerous for your privacy so I recommend to use WireGuard or OpenVPN.

Since ComfyUI is also a web app, you can configure it to use it on your phone and even via Internet.
I set up this environment and carry a laptop computer with WireGuard installed, so I can generate and manage images anywhere I go.
